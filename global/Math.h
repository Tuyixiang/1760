//
// Created by Yixiang Tu on 29/05/2018.
//

#ifndef INC_1760_MATH_H
#define INC_1760_MATH_H
#define PI 3.1415926f
static constexpr float sinValues[1441] = {0.000000, 0.001091, 0.002182, 0.003272, 0.004363, 0.005454, 0.006545,
                                          0.007636, 0.008727, 0.009817, 0.010908, 0.011999, 0.013090, 0.014180,
                                          0.015271, 0.016362, 0.017452, 0.018543, 0.019634, 0.020724, 0.021815,
                                          0.022905, 0.023996, 0.025086, 0.026177, 0.027267, 0.028358, 0.029448,
                                          0.030539, 0.031629, 0.032719, 0.033809, 0.034899, 0.035990, 0.037080,
                                          0.038170, 0.039260, 0.040350, 0.041440, 0.042530, 0.043619, 0.044709,
                                          0.045799, 0.046889, 0.047978, 0.049068, 0.050157, 0.051247, 0.052336,
                                          0.053425, 0.054515, 0.055604, 0.056693, 0.057782, 0.058871, 0.059960,
                                          0.061049, 0.062137, 0.063226, 0.064315, 0.065403, 0.066492, 0.067580,
                                          0.068668, 0.069756, 0.070845, 0.071933, 0.073021, 0.074108, 0.075196,
                                          0.076284, 0.077372, 0.078459, 0.079547, 0.080634, 0.081721, 0.082808,
                                          0.083895, 0.084982, 0.086069, 0.087156, 0.088242, 0.089329, 0.090415,
                                          0.091502, 0.092588, 0.093674, 0.094760, 0.095846, 0.096932, 0.098017,
                                          0.099103, 0.100188, 0.101273, 0.102359, 0.103444, 0.104528, 0.105613,
                                          0.106698, 0.107782, 0.108867, 0.109951, 0.111035, 0.112119, 0.113203,
                                          0.114287, 0.115371, 0.116454, 0.117537, 0.118621, 0.119704, 0.120787,
                                          0.121869, 0.122952, 0.124034, 0.125117, 0.126199, 0.127281, 0.128363,
                                          0.129445, 0.130526, 0.131608, 0.132689, 0.133770, 0.134851, 0.135932,
                                          0.137012, 0.138093, 0.139173, 0.140253, 0.141333, 0.142413, 0.143493,
                                          0.144572, 0.145651, 0.146730, 0.147809, 0.148888, 0.149967, 0.151045,
                                          0.152123, 0.153201, 0.154279, 0.155357, 0.156434, 0.157512, 0.158589,
                                          0.159666, 0.160743, 0.161819, 0.162895, 0.163972, 0.165048, 0.166123,
                                          0.167199, 0.168274, 0.169350, 0.170424, 0.171499, 0.172574, 0.173648,
                                          0.174722, 0.175796, 0.176870, 0.177944, 0.179017, 0.180090, 0.181163,
                                          0.182236, 0.183308, 0.184380, 0.185452, 0.186524, 0.187596, 0.188667,
                                          0.189738, 0.190809, 0.191880, 0.192950, 0.194020, 0.195090, 0.196160,
                                          0.197230, 0.198299, 0.199368, 0.200437, 0.201505, 0.202574, 0.203642,
                                          0.204710, 0.205777, 0.206845, 0.207912, 0.208979, 0.210045, 0.211112,
                                          0.212178, 0.213244, 0.214309, 0.215375, 0.216440, 0.217504, 0.218569,
                                          0.219633, 0.220697, 0.221761, 0.222825, 0.223888, 0.224951, 0.226014,
                                          0.227076, 0.228138, 0.229200, 0.230262, 0.231323, 0.232385, 0.233445,
                                          0.234506, 0.235566, 0.236626, 0.237686, 0.238745, 0.239804, 0.240863,
                                          0.241922, 0.242980, 0.244038, 0.245096, 0.246153, 0.247210, 0.248267,
                                          0.249324, 0.250380, 0.251436, 0.252492, 0.253547, 0.254602, 0.255657,
                                          0.256711, 0.257765, 0.258819, 0.259873, 0.260926, 0.261979, 0.263031,
                                          0.264083, 0.265135, 0.266187, 0.267238, 0.268289, 0.269340, 0.270390,
                                          0.271440, 0.272490, 0.273540, 0.274589, 0.275637, 0.276686, 0.277734,
                                          0.278782, 0.279829, 0.280876, 0.281923, 0.282969, 0.284015, 0.285061,
                                          0.286106, 0.287152, 0.288196, 0.289241, 0.290285, 0.291328, 0.292372,
                                          0.293415, 0.294457, 0.295500, 0.296542, 0.297583, 0.298624, 0.299665,
                                          0.300706, 0.301746, 0.302786, 0.303825, 0.304864, 0.305903, 0.306941,
                                          0.307979, 0.309017, 0.310054, 0.311091, 0.312128, 0.313164, 0.314200,
                                          0.315235, 0.316270, 0.317305, 0.318339, 0.319373, 0.320406, 0.321439,
                                          0.322472, 0.323505, 0.324537, 0.325568, 0.326599, 0.327630, 0.328661,
                                          0.329691, 0.330720, 0.331750, 0.332778, 0.333807, 0.334835, 0.335863,
                                          0.336890, 0.337917, 0.338943, 0.339969, 0.340995, 0.342020, 0.343045,
                                          0.344069, 0.345093, 0.346117, 0.347140, 0.348163, 0.349185, 0.350207,
                                          0.351229, 0.352250, 0.353271, 0.354291, 0.355311, 0.356330, 0.357349,
                                          0.358368, 0.359386, 0.360404, 0.361421, 0.362438, 0.363454, 0.364470,
                                          0.365486, 0.366501, 0.367516, 0.368530, 0.369544, 0.370557, 0.371570,
                                          0.372583, 0.373595, 0.374607, 0.375618, 0.376629, 0.377639, 0.378649,
                                          0.379658, 0.380667, 0.381675, 0.382683, 0.383691, 0.384698, 0.385705,
                                          0.386711, 0.387717, 0.388722, 0.389727, 0.390731, 0.391735, 0.392738,
                                          0.393741, 0.394744, 0.395746, 0.396747, 0.397748, 0.398749, 0.399749,
                                          0.400749, 0.401748, 0.402747, 0.403745, 0.404743, 0.405740, 0.406737,
                                          0.407733, 0.408729, 0.409724, 0.410719, 0.411713, 0.412707, 0.413700,
                                          0.414693, 0.415686, 0.416677, 0.417669, 0.418660, 0.419650, 0.420640,
                                          0.421629, 0.422618, 0.423607, 0.424595, 0.425582, 0.426569, 0.427555,
                                          0.428541, 0.429526, 0.430511, 0.431495, 0.432479, 0.433462, 0.434445,
                                          0.435428, 0.436409, 0.437390, 0.438371, 0.439351, 0.440331, 0.441310,
                                          0.442289, 0.443267, 0.444244, 0.445221, 0.446198, 0.447174, 0.448149,
                                          0.449124, 0.450098, 0.451072, 0.452046, 0.453018, 0.453990, 0.454962,
                                          0.455933, 0.456904, 0.457874, 0.458843, 0.459812, 0.460781, 0.461749,
                                          0.462716, 0.463683, 0.464649, 0.465615, 0.466580, 0.467544, 0.468508,
                                          0.469472, 0.470434, 0.471397, 0.472358, 0.473320, 0.474280, 0.475240,
                                          0.476200, 0.477159, 0.478117, 0.479075, 0.480032, 0.480989, 0.481945,
                                          0.482900, 0.483855, 0.484810, 0.485763, 0.486717, 0.487669, 0.488621,
                                          0.489573, 0.490524, 0.491474, 0.492424, 0.493373, 0.494321, 0.495269,
                                          0.496217, 0.497163, 0.498109, 0.499055, 0.500000, 0.500944, 0.501888,
                                          0.502831, 0.503774, 0.504716, 0.505657, 0.506598, 0.507538, 0.508478,
                                          0.509417, 0.510355, 0.511293, 0.512230, 0.513167, 0.514103, 0.515038,
                                          0.515973, 0.516907, 0.517840, 0.518773, 0.519706, 0.520637, 0.521568,
                                          0.522499, 0.523428, 0.524357, 0.525286, 0.526214, 0.527141, 0.528068,
                                          0.528994, 0.529919, 0.530844, 0.531768, 0.532692, 0.533615, 0.534537,
                                          0.535458, 0.536379, 0.537300, 0.538219, 0.539138, 0.540057, 0.540974,
                                          0.541892, 0.542808, 0.543724, 0.544639, 0.545554, 0.546467, 0.547381,
                                          0.548293, 0.549205, 0.550116, 0.551027, 0.551937, 0.552846, 0.553755,
                                          0.554663, 0.555570, 0.556477, 0.557383, 0.558288, 0.559193, 0.560097,
                                          0.561000, 0.561903, 0.562805, 0.563706, 0.564607, 0.565507, 0.566406,
                                          0.567305, 0.568203, 0.569100, 0.569997, 0.570893, 0.571788, 0.572683,
                                          0.573576, 0.574470, 0.575362, 0.576254, 0.577145, 0.578036, 0.578925,
                                          0.579815, 0.580703, 0.581591, 0.582478, 0.583364, 0.584250, 0.585135,
                                          0.586019, 0.586902, 0.587785, 0.588667, 0.589549, 0.590430, 0.591310,
                                          0.592189, 0.593068, 0.593946, 0.594823, 0.595699, 0.596575, 0.597450,
                                          0.598325, 0.599198, 0.600071, 0.600943, 0.601815, 0.602686, 0.603556,
                                          0.604425, 0.605294, 0.606162, 0.607029, 0.607896, 0.608761, 0.609626,
                                          0.610491, 0.611354, 0.612217, 0.613079, 0.613941, 0.614802, 0.615661,
                                          0.616521, 0.617379, 0.618237, 0.619094, 0.619950, 0.620806, 0.621661,
                                          0.622515, 0.623368, 0.624221, 0.625072, 0.625923, 0.626774, 0.627623,
                                          0.628472, 0.629320, 0.630168, 0.631014, 0.631860, 0.632705, 0.633550,
                                          0.634393, 0.635236, 0.636078, 0.636920, 0.637760, 0.638600, 0.639439,
                                          0.640277, 0.641115, 0.641952, 0.642788, 0.643623, 0.644457, 0.645291,
                                          0.646124, 0.646956, 0.647788, 0.648618, 0.649448, 0.650277, 0.651105,
                                          0.651933, 0.652760, 0.653586, 0.654411, 0.655235, 0.656059, 0.656882,
                                          0.657704, 0.658525, 0.659346, 0.660166, 0.660985, 0.661803, 0.662620,
                                          0.663437, 0.664252, 0.665067, 0.665882, 0.666695, 0.667508, 0.668320,
                                          0.669131, 0.669941, 0.670750, 0.671559, 0.672367, 0.673174, 0.673980,
                                          0.674786, 0.675590, 0.676394, 0.677197, 0.677999, 0.678801, 0.679601,
                                          0.680401, 0.681200, 0.681998, 0.682796, 0.683592, 0.684388, 0.685183,
                                          0.685977, 0.686770, 0.687563, 0.688355, 0.689145, 0.689935, 0.690725,
                                          0.691513, 0.692301, 0.693087, 0.693873, 0.694658, 0.695443, 0.696226,
                                          0.697009, 0.697790, 0.698571, 0.699352, 0.700131, 0.700909, 0.701687,
                                          0.702464, 0.703240, 0.704015, 0.704789, 0.705562, 0.706335, 0.707107,
                                          0.707878, 0.708648, 0.709417, 0.710185, 0.710953, 0.711720, 0.712485,
                                          0.713250, 0.714015, 0.714778, 0.715540, 0.716302, 0.717063, 0.717823,
                                          0.718582, 0.719340, 0.720097, 0.720854, 0.721609, 0.722364, 0.723118,
                                          0.723871, 0.724623, 0.725374, 0.726125, 0.726874, 0.727623, 0.728371,
                                          0.729118, 0.729864, 0.730609, 0.731354, 0.732097, 0.732840, 0.733582,
                                          0.734323, 0.735063, 0.735802, 0.736540, 0.737277, 0.738014, 0.738749,
                                          0.739484, 0.740218, 0.740951, 0.741683, 0.742414, 0.743145, 0.743874,
                                          0.744603, 0.745331, 0.746057, 0.746783, 0.747508, 0.748232, 0.748956,
                                          0.749678, 0.750400, 0.751120, 0.751840, 0.752559, 0.753276, 0.753993,
                                          0.754710, 0.755425, 0.756139, 0.756852, 0.757565, 0.758277, 0.758987,
                                          0.759697, 0.760406, 0.761114, 0.761821, 0.762527, 0.763232, 0.763937,
                                          0.764640, 0.765343, 0.766044, 0.766745, 0.767445, 0.768144, 0.768842,
                                          0.769539, 0.770235, 0.770930, 0.771625, 0.772318, 0.773010, 0.773702,
                                          0.774393, 0.775082, 0.775771, 0.776459, 0.777146, 0.777832, 0.778517,
                                          0.779201, 0.779884, 0.780567, 0.781248, 0.781929, 0.782608, 0.783287,
                                          0.783964, 0.784641, 0.785317, 0.785992, 0.786666, 0.787339, 0.788011,
                                          0.788682, 0.789352, 0.790021, 0.790690, 0.791357, 0.792023, 0.792689,
                                          0.793353, 0.794017, 0.794680, 0.795341, 0.796002, 0.796662, 0.797321,
                                          0.797979, 0.798636, 0.799292, 0.799947, 0.800601, 0.801254, 0.801906,
                                          0.802557, 0.803208, 0.803857, 0.804505, 0.805153, 0.805799, 0.806445,
                                          0.807089, 0.807733, 0.808375, 0.809017, 0.809658, 0.810297, 0.810936,
                                          0.811574, 0.812211, 0.812847, 0.813482, 0.814116, 0.814748, 0.815380,
                                          0.816012, 0.816642, 0.817271, 0.817899, 0.818526, 0.819152, 0.819777,
                                          0.820401, 0.821025, 0.821647, 0.822268, 0.822889, 0.823508, 0.824126,
                                          0.824744, 0.825360, 0.825975, 0.826590, 0.827203, 0.827816, 0.828427,
                                          0.829038, 0.829647, 0.830256, 0.830863, 0.831470, 0.832075, 0.832680,
                                          0.833283, 0.833886, 0.834487, 0.835088, 0.835688, 0.836286, 0.836884,
                                          0.837480, 0.838076, 0.838671, 0.839264, 0.839857, 0.840448, 0.841039,
                                          0.841629, 0.842217, 0.842805, 0.843391, 0.843977, 0.844562, 0.845145,
                                          0.845728, 0.846309, 0.846890, 0.847470, 0.848048, 0.848626, 0.849202,
                                          0.849778, 0.850352, 0.850926, 0.851498, 0.852070, 0.852640, 0.853210,
                                          0.853778, 0.854345, 0.854912, 0.855477, 0.856042, 0.856605, 0.857167,
                                          0.857729, 0.858289, 0.858848, 0.859406, 0.859964, 0.860520, 0.861075,
                                          0.861629, 0.862182, 0.862734, 0.863285, 0.863836, 0.864385, 0.864933,
                                          0.865479, 0.866025, 0.866570, 0.867114, 0.867657, 0.868199, 0.868740,
                                          0.869279, 0.869818, 0.870356, 0.870892, 0.871428, 0.871962, 0.872496,
                                          0.873028, 0.873560, 0.874090, 0.874620, 0.875148, 0.875675, 0.876202,
                                          0.876727, 0.877251, 0.877774, 0.878296, 0.878817, 0.879337, 0.879856,
                                          0.880374, 0.880891, 0.881407, 0.881921, 0.882435, 0.882948, 0.883459,
                                          0.883970, 0.884479, 0.884988, 0.885495, 0.886001, 0.886507, 0.887011,
                                          0.887514, 0.888016, 0.888517, 0.889017, 0.889516, 0.890014, 0.890511,
                                          0.891007, 0.891501, 0.891995, 0.892487, 0.892979, 0.893469, 0.893959,
                                          0.894447, 0.894934, 0.895421, 0.895906, 0.896390, 0.896873, 0.897355,
                                          0.897836, 0.898315, 0.898794, 0.899272, 0.899748, 0.900224, 0.900698,
                                          0.901172, 0.901644, 0.902115, 0.902585, 0.903054, 0.903522, 0.903989,
                                          0.904455, 0.904920, 0.905384, 0.905846, 0.906308, 0.906768, 0.907228,
                                          0.907686, 0.908143, 0.908599, 0.909054, 0.909508, 0.909961, 0.910413,
                                          0.910864, 0.911313, 0.911762, 0.912210, 0.912656, 0.913101, 0.913545,
                                          0.913989, 0.914431, 0.914872, 0.915311, 0.915750, 0.916188, 0.916625,
                                          0.917060, 0.917494, 0.917928, 0.918360, 0.918791, 0.919221, 0.919650,
                                          0.920078, 0.920505, 0.920931, 0.921355, 0.921779, 0.922201, 0.922622,
                                          0.923042, 0.923462, 0.923880, 0.924296, 0.924712, 0.925127, 0.925541,
                                          0.925953, 0.926364, 0.926775, 0.927184, 0.927592, 0.927999, 0.928405,
                                          0.928810, 0.929213, 0.929616, 0.930017, 0.930418, 0.930817, 0.931215,
                                          0.931612, 0.932008, 0.932403, 0.932796, 0.933189, 0.933580, 0.933971,
                                          0.934360, 0.934748, 0.935135, 0.935521, 0.935906, 0.936290, 0.936672,
                                          0.937054, 0.937434, 0.937813, 0.938191, 0.938568, 0.938944, 0.939319,
                                          0.939693, 0.940065, 0.940437, 0.940807, 0.941176, 0.941544, 0.941911,
                                          0.942277, 0.942641, 0.943005, 0.943368, 0.943729, 0.944089, 0.944448,
                                          0.944806, 0.945163, 0.945519, 0.945873, 0.946227, 0.946579, 0.946930,
                                          0.947280, 0.947629, 0.947977, 0.948324, 0.948669, 0.949014, 0.949357,
                                          0.949699, 0.950040, 0.950380, 0.950719, 0.951057, 0.951393, 0.951728,
                                          0.952063, 0.952396, 0.952728, 0.953059, 0.953388, 0.953717, 0.954044,
                                          0.954371, 0.954696, 0.955020, 0.955343, 0.955665, 0.955985, 0.956305,
                                          0.956623, 0.956940, 0.957256, 0.957571, 0.957885, 0.958198, 0.958509,
                                          0.958820, 0.959129, 0.959437, 0.959744, 0.960050, 0.960355, 0.960658,
                                          0.960960, 0.961262, 0.961562, 0.961861, 0.962159, 0.962455, 0.962751,
                                          0.963045, 0.963338, 0.963630, 0.963921, 0.964211, 0.964500, 0.964787,
                                          0.965074, 0.965359, 0.965643, 0.965926, 0.966208, 0.966488, 0.966768,
                                          0.967046, 0.967323, 0.967599, 0.967874, 0.968148, 0.968420, 0.968692,
                                          0.968962, 0.969231, 0.969499, 0.969766, 0.970031, 0.970296, 0.970559,
                                          0.970821, 0.971082, 0.971342, 0.971601, 0.971858, 0.972115, 0.972370,
                                          0.972624, 0.972877, 0.973129, 0.973379, 0.973629, 0.973877, 0.974124,
                                          0.974370, 0.974615, 0.974859, 0.975101, 0.975342, 0.975582, 0.975821,
                                          0.976059, 0.976296, 0.976532, 0.976766, 0.976999, 0.977231, 0.977462,
                                          0.977692, 0.977920, 0.978148, 0.978374, 0.978599, 0.978823, 0.979045,
                                          0.979267, 0.979487, 0.979707, 0.979925, 0.980142, 0.980357, 0.980572,
                                          0.980785, 0.980998, 0.981209, 0.981418, 0.981627, 0.981835, 0.982041,
                                          0.982246, 0.982450, 0.982653, 0.982855, 0.983056, 0.983255, 0.983453,
                                          0.983650, 0.983846, 0.984041, 0.984234, 0.984427, 0.984618, 0.984808,
                                          0.984997, 0.985184, 0.985371, 0.985556, 0.985740, 0.985923, 0.986105,
                                          0.986286, 0.986465, 0.986643, 0.986820, 0.986996, 0.987171, 0.987345,
                                          0.987517, 0.987688, 0.987858, 0.988027, 0.988195, 0.988362, 0.988527,
                                          0.988691, 0.988854, 0.989016, 0.989177, 0.989336, 0.989494, 0.989651,
                                          0.989807, 0.989962, 0.990116, 0.990268, 0.990419, 0.990569, 0.990718,
                                          0.990866, 0.991012, 0.991158, 0.991302, 0.991445, 0.991587, 0.991727,
                                          0.991867, 0.992005, 0.992142, 0.992278, 0.992413, 0.992546, 0.992678,
                                          0.992810, 0.992940, 0.993068, 0.993196, 0.993323, 0.993448, 0.993572,
                                          0.993695, 0.993816, 0.993937, 0.994056, 0.994175, 0.994291, 0.994407,
                                          0.994522, 0.994635, 0.994748, 0.994859, 0.994969, 0.995077, 0.995185,
                                          0.995291, 0.995396, 0.995500, 0.995603, 0.995705, 0.995805, 0.995904,
                                          0.996002, 0.996099, 0.996195, 0.996289, 0.996382, 0.996475, 0.996566,
                                          0.996655, 0.996744, 0.996831, 0.996917, 0.997002, 0.997086, 0.997169,
                                          0.997250, 0.997330, 0.997409, 0.997487, 0.997564, 0.997640, 0.997714,
                                          0.997787, 0.997859, 0.997930, 0.997999, 0.998068, 0.998135, 0.998201,
                                          0.998266, 0.998329, 0.998392, 0.998453, 0.998513, 0.998572, 0.998630,
                                          0.998686, 0.998741, 0.998795, 0.998848, 0.998900, 0.998951, 0.999000,
                                          0.999048, 0.999095, 0.999141, 0.999186, 0.999229, 0.999271, 0.999312,
                                          0.999352, 0.999391, 0.999428, 0.999465, 0.999500, 0.999534, 0.999566,
                                          0.999598, 0.999628, 0.999657, 0.999685, 0.999712, 0.999738, 0.999762,
                                          0.999785, 0.999807, 0.999828, 0.999848, 0.999866, 0.999883, 0.999899,
                                          0.999914, 0.999928, 0.999941, 0.999952, 0.999962, 0.999971, 0.999979,
                                          0.999985, 0.999990, 0.999995, 0.999998, 0.999999, 1.000000};
static constexpr float sin(int& x) {
  if (x >= 5760) {
    x -= 5760;
  }
  if (x > 4320) {
    return -sinValues[5760 - x];
  }
  if (x >= 2880) {
    return -sinValues[x - 2880];
  }
  if (x > 1440) {
    return sinValues[2880 - x];
  }
  assert(x >= 0);
  return sinValues[x];
}

static constexpr float cos(int& x) {
  if (x >= 5760) {
    x -= 5760;
  }
  if (x > 4320) {
    return sinValues[x - 4320];
  }
  if (x >= 2880) {
    return -sinValues[4320 - x];
  }
  if (x > 1440) {
    return -sinValues[x - 1440];
  }
  assert(x >= 0);
  return sinValues[1440 - x];
}

static constexpr float sq(float x) {
  return x * x;
}

static constexpr int sq(int x) {
  return x * x;
}

static constexpr float min(float a, float b) {
  return a < b ? a : b;
}

static constexpr float max(float a, float b) {
  return a > b ? a : b;
}

static constexpr float sign(float x) {
  return x > 0.0f ? 1.0f : x < 0.0f ? -1.0f : 0.0f;
}

#endif //INC_1760_MATH_H
